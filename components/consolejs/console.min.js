/*!
 * console.js 0.2
 * http://evilmarty.github.com/consolejs/
 *
 * Copyright 2011, Marty Zalega
 * Under the MIT license.
 * http://www.opensource.org/licenses/MIT
 */
(function(){function f(a,b){var c=document.createElement(a);if(b)for(var d in b)c.setAttribute(d,b[d]);for(d=2;d<arguments.length;++d)c.appendChild(arguments[d]);return c}function h(a,b){if(typeof a==="string"||typeof a==="number")return document.createTextNode(a);a.appendChild(document.createTextNode(b));return a}function r(a){for(var b=[],c=1;c<arguments.length;++c)b=b.concat(arguments[c].split(/\s+/));if(a.classList)for(c in b)a.classList.add(b[c]);else b=a.className.split(/\s+/)+b,a.className=
b.join(" ");return a}function n(a,b,c){var d="on"+b;if(a.addEventListener)return a.addEventListener(b,c,false);else if(a.attachEvent)return a.attachEvent(d,c);else if(d in a)return a[d]=c}function s(a){for(var b=1;b<arguments.length;++b){var c=arguments[b],d;for(d in c)a[d]=c[d]}return a}function o(a,b){var c=Array.prototype.slice.call(arguments).slice(2);return function(){a.apply(b||this,c.concat(Array.prototype.slice.call(arguments)))}}function t(a){return Object.prototype.toString.call(a)==="[object Array]"?
"array":Object.prototype.toString.call(a)==="[object Error]"?"error":a===null?"null":a&&a.nodeType==1?"element":typeof a}function l(a,b){var c=t(a);switch(c){case "null":case "undefined":return f("span",{"class":c},h(c));case "array":var d=f("ol",{"class":c}),e;for(e in a)c=a[e],d.appendChild(f("li",null,l(c)));return d;case "object":e=f("dl",{"class":c});for(d in a)d in a.__proto__||(c=b===false?h(d):l(a[d],false),e.appendChild(f("dt",null,h(d))),e.appendChild(f("dd",null,c)));return e;case "element":e=
a.nodeName.toLowerCase();var d=f("dl"),k=f("div",{"class":"open"},h(e),d),j=f("div",{"class":"close"},h(e)),i=f("div",{"class":"content"},h(a.innerHTML));for(e=0;e<a.attributes.length;++e){var g=a.attributes[e];d.appendChild(f("dt",null,h(g.name)));d.appendChild(f("dd",null,h(g.value)))}return f("div",{"class":c},k,i,j);default:return f("span",{"class":c},h(a.toString()))}}var u={},v=function(){var a=-1,b=[];return s(this,{clear:function(){b=[]},reset:function(){a=b.length},previous:function(){return b[a=
Math.max(--a,0)]},next:function(){return b[a=Math.min(++a,b.length)]},push:function(a){b[b.length-1]!==a&&(b.push(a),this.reset())}})},p=function(a,b){function c(a){var b=arguments.length===2?arguments[1]:Array.prototype.slice.call(arguments).slice(1),c=f("div",{"class":"result"},l(b)),b=r(f("p",null,c),t(b),a);j.insertBefore(b,i);return b}function d(a){if(a){var d=h(f("div",{"class":"command"}),a),e="info",g;try{g=function(){with(b)return eval(a)}.call(b)}catch(i){g=i,e="error"}e=c(e,g);e.insertBefore(d,
e.childNodes[0]);e.scrollTop=e.scrollHeight;j.scrollTop=j.scrollHeight;m.push(a)}}typeof a=="string"&&(a=document.getElementById(a));var e=u[a];if(e)return e.cd(b),e;else if(!(this instanceof p))return e||(e=new p(a,b)),e;u[a]=this;b||(b=window);for(var k=f("div");node=a.childNodes[0];)k.appendChild(node);var j=f("div",{"class":"console-container"}),i=f("p",{"class":"console-input"}),g=f("textarea",{row:1}),q={className:a.className,tabIndex:a.tabIndex};i.appendChild(g);j.appendChild(i);r(a,"console").appendChild(j);
if(a.tabIndex<0)a.tabIndex=0;n(a,"focus",function(){g.focus()});var m=new v;n(g,"keydown",function(a){switch(a.keyCode){case 13:return a.preventDefault(),d(this.value),this.value="",false;case 38:if(cmd=m.previous())g.value=cmd;a.preventDefault();return false;case 40:return g.value=(cmd=m.next())?cmd:"",a.preventDefault(),false}});n(g,"blur",function(){m.reset()});return s(this,{cd:function(a){b=a},log:function(){this.info.apply(this,arguments)},info:o(c,this,"info"),warn:o(c,this,"warn"),error:o(c,
this,"error"),clear:function(){for(var a=i.previousSibling;a;){var b=a,a=b.previousSibling;b.parentNode.removeChild(b)}},destroy:function(){for(var b in q)a[b]=q[b];for(;node=a.childNodes[0];)a.removeChild(node);for(;node=k.childNodes[0];)a.appendChild(node);delete k;delete l;delete g;delete q}})};window.Console=p})();
